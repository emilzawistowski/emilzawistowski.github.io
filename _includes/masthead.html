{% comment %}
Custom masthead with profile photo, name, home icon, domain nav, and social links
{% endcomment %}

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__left">
      {% comment %}Profile photo and name - both link to gateway{% endcomment %}
      <a href="/" class="masthead__profile">
        {% if site.author.avatar %}
          <img src="{{ site.author.avatar | relative_url }}" alt="{{ site.author.name }}" class="masthead__avatar">
        {% endif %}
        <span class="masthead__name">{{ site.author.name | default: site.title }}</span>
      </a>
      
      {% comment %}Home icon - links to gateway{% endcomment %}
      <a href="/" class="masthead__home-icon" aria-label="Home">
        <i class="fas fa-home"></i>
      </a>
    </div>

    <div class="masthead__right">
      {% comment %}Domain-specific navigation{% endcomment %}
      <nav class="masthead__menu">
        <ul class="visible-links">
          {% assign navigation = site.data.navigation[page.navigation] | default: site.data.navigation.main %}
          {% for link in navigation %}
            <li class="masthead__menu-item">
              <a href="{{ link.url | relative_url }}">{{ link.title }}</a>
            </li>
          {% endfor %}
        </ul>
      </nav>

      {% comment %}Domain-specific social links + shared (both){% endcomment %}
      <div class="masthead__social">
        {% comment %}Determine current domain from page URL{% endcomment %}
        {% if page.url contains '/research/' %}
          {% assign current_domain = 'research' %}
        {% elsif page.url contains '/creative/' %}
          {% assign current_domain = 'creative' %}
        {% else %}
          {% assign current_domain = 'none' %}
        {% endif %}

        {% for link in site.data.external_links %}
          {% if link.domain == current_domain or link.domain == 'both' %}
            <a href="{% if link.url %}{{ link.url }}{% else %}#{% endif %}" 
               class="masthead__social-link" 
               {% if link.url contains 'http' %}target="_blank" rel="noopener noreferrer"{% endif %}
               aria-label="{{ link.name }}">
              <i class="{{ link.icon }}"></i>
              {% if link.text %}
                <span class="masthead__social-text">{{ link.text }}</span>
              {% endif %}
            </a>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>